<!DOCTYPE html>
<head>
  
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PPZPQ6');</script>
  <!-- End Google Tag Manager -->
    <title>Lab 2: ADFS Proxy using ADFS Authentication</title>
  

  <meta charset="utf-8">
  <!-- Twitter Bootstrap viewport setting -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- F5 metadata -->
  <meta name="title" content="Lab 2: ADFS Proxy using ADFS Authentication"/>
  <meta name="product" content="F5 Identity and Access Management Solutions"/>
  <meta name="version" content=""/>
  <meta name="updated_date"  content="2021-06-21 13:45:41"/>
  <meta name="archived" content="Archived documents excluded"/>
  <meta name="doc_type" content="Manual"/>
  <meta name="lifecycle" content="release"/>
  <meta name="F5 Identity and Access Management Solutions" content=""/>


  

  
  <link href="https://cdn.f5.com/favicon.ico" rel="icon">

</head>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lab 2: ADFS Proxy using ADFS Authentication &#8212; F5 Identity and Access Management Solutions  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" href="../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/f5.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/f5-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/CoveoFullSearch.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    <link rel="stylesheet" href="https://use.fontawesome.com/21fb8a09c3.css" type="text/css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Lab 3: ADFS Proxy using Endpoint Checks" href="lab03.html" />
    <link rel="prev" title="Lab 1: Azure AD Easy Button integration" href="lab01.html" /> 
  </head><body>
  <div id="clouddocs-header"></div>

    <div id="sidebar" class="section-nav">
      
      <!--  version selector ------------------>
      <div id="version_selector_wrapper">
      </div>
      <nav class="nav-sidebartoc">

        
         <h5>F5 Identity and Access Management Solutions  </h5>
        

        <hr>
        <span class="nav-sidebartoc">
            <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../class1/class1.html">100 Series: Access Foundational Concepts</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../class2.html">200 Series: Assisted Deployment Use Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class3/class3.html">300 Series: Advanced Use Cases &amp; Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class4/class4.html">400 Series: Access Automation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class5/class5.html">500 Series: Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../archived/archived.html">Archived Identity &amp; Access Management Labs</a></li>
</ul>

        </span><!-- Use this file to add extra links to the bottom of the ToC sidebar -->
<hr>
  <span class="nav-sidebartoc">
 <!-- insert content here -->
  </span>
      </nav>
    </div>


    <div id="right-sidebar">
      <h7 style="font-weight:normal">On this page:</h7>
      <nav class="nav-sidebartoc">
        <span class="nav-sidebartoc">
            <ul>
<li><a class="reference internal" href="#">Lab 2: ADFS Proxy using ADFS Authentication</a><ul>
<li><a class="reference internal" href="#task-1-setup-lab-environment">Task 1 - Setup Lab Environment</a></li>
<li><a class="reference internal" href="#task-2-access-the-microsoft-adfs-guided-configuration">Task 2 - Access the Microsoft ADFS guided configuration</a></li>
<li><a class="reference internal" href="#task-3-adfs-proxy-settings">Task 3 - ADFS Proxy Settings</a></li>
<li><a class="reference internal" href="#task-4-virtual-server-properties">Task 4 - Virtual Server Properties</a></li>
<li><a class="reference internal" href="#task-5-adfs-server-pool-properties">Task 5 - ADFS Server Pool Properties</a></li>
<li><a class="reference internal" href="#task-6-summary">Task 6 - Summary</a></li>
<li><a class="reference internal" href="#task-7-test-username-and-password-authenticaiton">Task 7 - Test username and password Authenticaiton</a></li>
<li><a class="reference internal" href="#task-8-test-certificate-authentication">Task 8 - Test Certificate authentication</a></li>
<li><a class="reference internal" href="#task-9-lab-cleanup">Task 9 - Lab Cleanup</a></li>
</ul>
</li>
</ul>

         </span>
      </nav>
    </div>





  
  <div class="main active" id="content" >
    <article class="docs-container site-article-inner">
              <!-- custom breadcrumb -->
        <h5>
            <a href="../../index.html">F5 Identity and Access Management Solutions</a>
              &gt; <a href="../class2.html">200 Series: Assisted Deployment Use Cases</a>

          <span class="right">
             <a href="../../_sources/class2/module4/lab02.rst.txt" rel="nofollow">Source</a> |
             <a href="https://github.com/f5devcentral/f5-agility-labs-iam">Edit on <i class="fa fa-github" aria-hidden="true"></i></a>
          </span>
        </h5>
        <!-- end custom breadcrumb -->
      


    <!--a title="Export PDF" id="export-pdf" class="btn btn btn-link pull-right">View PDF</a-->
    <button type="button" id="export-pdf" class="btn btn-link right">PDF</button>


    
     
         <div class="sidebar" id="version-warning" style="display: none;">
           <p class="first sidebar-title">
           <span class="icon fa fa-info-circle fa-lg"></span> Version notice:</p>
           <p class="last" id="currentVersion"></p>
          </div>


     <div role="main">
        
  <div class="section" id="lab-2-adfs-proxy-using-adfs-authentication">
<h1>Lab 2: ADFS Proxy using ADFS Authentication<a class="headerlink" href="#lab-2-adfs-proxy-using-adfs-authentication" title="Permalink to this headline">¶</a></h1>
<div class="section" id="task-1-setup-lab-environment">
<h2>Task 1 - Setup Lab Environment<a class="headerlink" href="#task-1-setup-lab-environment" title="Permalink to this headline">¶</a></h2>
<p>To access your dedicated student lab environment, you will require a web browser and Remote Desktop Protocol (RDP) client software. The web browser will be used to access the Lab Training Portal. The RDP client will be used to connect to the Jump Host, where you will be able to access the BIG-IP management interfaces (HTTPS, SSH).</p>
<ol class="arabic">
<li><p class="first">Click <strong>DEPLOYMENT</strong> located on the top left corner to display the environment</p>
</li>
<li><p class="first">Click <strong>ACCESS</strong> next to jumpohost.f5lab.local</p>
<p><img alt="image001" src="../../_images/0016.png" /></p>
</li>
<li><p class="first">Select your RDP resolution.</p>
</li>
<li><p class="first">The RDP client on your local host establishes a RDP connection to the Jumphost.</p>
</li>
<li><p class="first">Login with the following credentials:</p>
<blockquote>
<div><ul class="simple">
<li>User: <strong>f5lab\user1</strong></li>
<li>Password: <strong>user1</strong></li>
</ul>
</div></blockquote>
</li>
<li><p class="first">After successful logon the Chrome browser will auto launch opening the site <a class="reference external" href="https://portal.f5lab.local">https://portal.f5lab.local</a>.  This process usually takes 30 seconds after logon.</p>
</li>
<li><p class="first">Click the <strong>Classes</strong> tab at the top of the page.</p>
<blockquote>
<div><p><img alt="image002" src="../../_images/0026.png" /></p>
</div></blockquote>
</li>
<li><p class="first">Scroll down the page until you see <strong>203 Microsoft Integrations</strong> on the left</p>
<p><img alt="image003" src="../../_images/0036.png" /></p>
</li>
<li><p class="first">Hover over tile <strong>ADFS Proxy using ADFS Authentication</strong>. A start and stop icon should appear within the tile.  Click the <strong>Play</strong> Button to start the automation to build the environment</p>
<table border="1" class="docutils align-default">
<colgroup>
<col width="54%" />
<col width="46%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><img alt="image004" src="../../_images/0046.png" /></td>
<td><img alt="image005" src="../../_images/0056.png" /></td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">The screen should refresh displaying the progress of the automation within 30 seconds.  Scroll to the bottom of the automation workflow to ensure all requests succeeded.  If you experience errors try running the automation a second time or open an issue on the <a class="reference external" href="https://github.com/f5devcentral/access-labs">Access Labs Repo</a>.</p>
<p><img alt="image006" src="../../_images/0066.png" /></p>
</li>
</ol>
</div>
<div class="section" id="task-2-access-the-microsoft-adfs-guided-configuration">
<h2>Task 2 - Access the Microsoft ADFS guided configuration<a class="headerlink" href="#task-2-access-the-microsoft-adfs-guided-configuration" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">From the jumphost browser navigate to <a class="reference external" href="https://bigip1.f5lab.local">https://bigip1.f5lab.local</a></p>
</li>
<li><p class="first">Login with the following credentials:</p>
<ul class="simple">
<li>username <strong>admin</strong></li>
<li>password <strong>admin</strong></li>
</ul>
</li>
<li><p class="first">Click on the <strong>Access</strong> tab located on the left side.</p>
<blockquote>
<div><p><img alt="image007" src="../../_images/0077.png" /></p>
</div></blockquote>
</li>
<li><p class="first">Click <strong>Guided Configuration</strong></p>
<blockquote>
<div><p><img alt="image008" src="../../_images/0086.png" /></p>
</div></blockquote>
</li>
<li><p class="first">Click <strong>Microsoft Integration</strong></p>
<blockquote>
<div><p><img alt="image009" src="../../_images/0096.png" /></p>
</div></blockquote>
</li>
<li><p class="first">Click <strong>ADFS Proxy</strong></p>
<blockquote>
<div><p><img alt="image010" src="../../_images/0107.png" /></p>
</div></blockquote>
</li>
<li><p class="first">Click <strong>Next</strong></p>
<blockquote>
<div><p><img alt="image011" src="../../_images/0118.png" /></p>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="task-3-adfs-proxy-settings">
<h2>Task 3 - ADFS Proxy Settings<a class="headerlink" href="#task-3-adfs-proxy-settings" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Enter the Configuration Name <strong>ADFS_PROXY</strong></p>
</li>
<li><p class="first">Enter the ADFS FQDN <strong>adfs.acme.com</strong></p>
</li>
<li><p class="first">Select the Authenticatin Method <strong>ADFS Authentication</strong></p>
</li>
<li><p class="first">Click <strong>Save &amp; Next</strong></p>
<blockquote>
<div><p><img alt="image012" src="../../_images/0128.png" /></p>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="task-4-virtual-server-properties">
<h2>Task 4 - Virtual Server Properties<a class="headerlink" href="#task-4-virtual-server-properties" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Enter the Destination Address <strong>10.1.10.101</strong></p>
</li>
<li><p class="first">Select the Client SSL Certificate <strong>acme.com-wildcard</strong></p>
</li>
<li><p class="first">Select the Associated Private Key <strong>acme.com-wilcard</strong></p>
</li>
<li><p class="first">From the Trusted Certificate Authorities for Client Authentication dropdown select <strong>ca.f5lab.local</strong></p>
</li>
<li><p class="first">Click <strong>Save &amp; Next</strong></p>
<blockquote>
<div><p><img alt="image013" src="../../_images/0138.png" /></p>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="task-5-adfs-server-pool-properties">
<h2>Task 5 - ADFS Server Pool Properties<a class="headerlink" href="#task-5-adfs-server-pool-properties" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Enter the IP address <strong>10.1.20.13</strong></p>
</li>
<li><p class="first">Click <strong>Save &amp; Next</strong></p>
<blockquote>
<div><p><img alt="image014" src="../../_images/0147.png" /></p>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="task-6-summary">
<h2>Task 6 - Summary<a class="headerlink" href="#task-6-summary" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Click <strong>Deploy</strong></p>
<blockquote>
<div><p><img alt="image015" src="../../_images/0157.png" /></p>
</div></blockquote>
</li>
<li><p class="first">Click <strong>Establish Trust</strong></p>
<blockquote>
<div><p><img alt="image016" src="../../_images/0166.png" /></p>
</div></blockquote>
</li>
<li><p class="first">Enter the Username <strong>admin</strong></p>
</li>
<li><p class="first">Enter the Password <strong>admin</strong></p>
</li>
<li><p class="first">Click <strong>Establish Trust</strong></p>
<blockquote>
<div><p><img alt="image017" src="../../_images/0176.png" /></p>
</div></blockquote>
</li>
<li><p class="first">A certificate appears under the <strong>Establish Trust</strong> section signifying the trust was successfully established.</p>
</li>
<li><p class="first">Click <strong>Finish</strong></p>
<blockquote>
<div><p><img alt="image018" src="../../_images/0186.png" /></p>
</div></blockquote>
</li>
<li><p class="first">The configuration has been successfully deployed</p>
<p><img alt="image019" src="../../_images/0197.png" /></p>
</li>
</ol>
</div>
<div class="section" id="task-7-test-username-and-password-authenticaiton">
<h2>Task 7 - Test username and password Authenticaiton<a class="headerlink" href="#task-7-test-username-and-password-authenticaiton" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">On the jumphost open a webbrowser and navigate to <a class="reference external" href="https://sp.acme.com">https://sp.acme.com</a>.  You will redirected to <a class="reference external" href="https://adfs.acme.com">https://adfs.acme.com</a></p>
</li>
<li><p class="first">Enter the username <strong>user1&#64;f5lab.local</strong></p>
</li>
<li><p class="first">Enter the password <strong>user1</strong></p>
</li>
<li><p class="first">Click <strong>Sign in</strong></p>
<blockquote>
<div><p><img alt="image020" src="../../_images/0206.png" /></p>
</div></blockquote>
</li>
<li><p class="first">After successful login at ADFS you redirected to <a class="reference external" href="http://sp.acme.com">http://sp.acme.com</a></p>
<p><img alt="image021" src="../../_images/0215.png" /></p>
</li>
</ol>
</div>
<div class="section" id="task-8-test-certificate-authentication">
<h2>Task 8 - Test Certificate authentication<a class="headerlink" href="#task-8-test-certificate-authentication" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Close the browser completely from the previous test or open a new tab in ingonito(private) view</p>
</li>
<li><p class="first">On the jumphost open a webbrowser and navigate to <a class="reference external" href="https://sp.acme.com">https://sp.acme.com</a>.  You will redirected to <a class="reference external" href="https://adfs.acme.com">https://adfs.acme.com</a></p>
</li>
<li><p class="first">Select <strong>Sign in using an X.509 Certificate</strong></p>
<blockquote>
<div><p><img alt="image022" src="../../_images/0225.png" /></p>
</div></blockquote>
</li>
<li><p class="first">Select the <strong>user1</strong> certificate</p>
</li>
<li><p class="first">Click <strong>OK</strong></p>
<blockquote>
<div><p><img alt="image023" src="../../_images/0236.png" /></p>
</div></blockquote>
</li>
<li><p class="first">After successful login at ADFS you redirected to <a class="reference external" href="http://sp.acme.com">http://sp.acme.com</a></p>
<p><img alt="image021" src="../../_images/0215.png" /></p>
</li>
</ol>
</div>
<div class="section" id="task-9-lab-cleanup">
<h2>Task 9 - Lab Cleanup<a class="headerlink" href="#task-9-lab-cleanup" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">From the jumphost browser navigate to <a class="reference external" href="https://bigip1.f5lab.local">https://bigip1.f5lab.local</a></p>
</li>
<li><p class="first">Login with the following credentials:</p>
<ul class="simple">
<li>username <strong>admin</strong></li>
<li>password <strong>admin</strong></li>
</ul>
</li>
<li><p class="first">Navigate to <strong>Access -&gt; Guided Configuration</strong> in the left-hand menu.</p>
<blockquote>
<div><p><img alt="image008" src="../../_images/0086.png" /></p>
</div></blockquote>
</li>
<li><p class="first">Click the <strong>Undeploy</strong> button</p>
<blockquote>
<div><p><img alt="image024" src="../../_images/0245.png" /></p>
</div></blockquote>
</li>
<li><p class="first">Click <strong>OK</strong> when asked, “Are you sure you want to undeploy this configuration?”</p>
<blockquote>
<div><p><img alt="image025" src="../../_images/0255.png" /></p>
</div></blockquote>
</li>
<li><p class="first">Click the <strong>Delete</strong> button once the deployment is undeployed</p>
<blockquote>
<div><p><img alt="image026" src="../../_images/0265.png" /></p>
</div></blockquote>
</li>
<li><p class="first">Click <strong>OK</strong> when asked, “Are you sure you want to delete this configuration?”</p>
<blockquote>
<div><p><img alt="image027" src="../../_images/0274.png" /></p>
</div></blockquote>
</li>
<li><p class="first">The Configuration section should now be empty</p>
<blockquote>
<div><p><img alt="image028" src="../../_images/0284.png" /></p>
</div></blockquote>
</li>
<li><p class="first">From a browser on the jumphost navigate to <a class="reference external" href="https://portal.f5lab.local">https://portal.f5lab.local</a></p>
</li>
<li><p class="first">Click the <strong>Classes</strong> tab at the top of the page.</p>
<blockquote>
<div><p><img alt="image002" src="../../_images/0026.png" /></p>
</div></blockquote>
</li>
<li><p class="first">Scroll down the page until you see <strong>203 - Microsoft Integration</strong> on the left</p>
<blockquote>
<div><p><img alt="image003" src="../../_images/0036.png" /></p>
</div></blockquote>
</li>
<li><p class="first">Hover over the tile <strong>AADFS Authentication</strong>. A start and stop icon should appear within the tile.  Click the <strong>Stop</strong> Button to start the automation to delete any prebuilt objects</p>
<blockquote>
<div><table border="1" class="docutils align-default">
<colgroup>
<col width="54%" />
<col width="46%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><img alt="image004" src="../../_images/0046.png" /></td>
<td><img alt="image029" src="../../_images/0294.png" /></td>
</tr>
</tbody>
</table>
</div></blockquote>
</li>
<li><p class="first">The screen should refresh displaying the progress of the automation within 30 seconds. Scroll to the bottom of the automation workflow to ensure all requests succeeded. If you you experience errors try running the automation a second time or open an issue on the <a class="reference external" href="https://github.com/f5devcentral/access-labs">Access Labs Repo</a>.</p>
<blockquote>
<div><p><img alt="image030" src="../../_images/0303.png" /></p>
</div></blockquote>
</li>
<li><p class="first">This concludes Lab 2.</p>
<blockquote>
<div><p><img alt="image000" src="../../_images/00010.png" /></p>
</div></blockquote>
</li>
</ol>
</div>
</div>


     </div>
    
     <div class="row next-prev-btn-row">
       <div class="col-lg-12">
       
        <a href="lab01.html" title="Lab 1: Azure AD Easy Button integration" accesskey="p" class="btn btn-primary left"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous</a>
       
       
          <a href="lab03.html" title="Lab 3: ADFS Proxy using Endpoint Checks" accesskey="n" class="btn btn-primary right">Next <i class="fa fa-arrow-circle-right" aria-hidden="true"></i></a>
       
     </div>
     </div>
    

    </article>
  </div>

</div>


  <div id="clouddocs-footer"></div>
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->

  <script src="../../_static/js/index.js"></script>
  <script src="../../_static/js/jquery.appear.js"></script>
  <script src="../../_static/js/printThis.js"></script>
  <script src="../../_static/js/bootstrap.min.js"></script>
  <script src="../../_static/js/clouddocs.js"></script>
  <script src="../../_static/js/CoveoJsSearch.Lazy.min.js"></script>
  </body>
</html>