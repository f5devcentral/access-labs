<!DOCTYPE html>
<head>
  
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PPZPQ6');</script>
  <!-- End Google Tag Manager -->
    <title>Lab 4: Explore AccessGuard(16.0)</title>
  

  <meta charset="utf-8">
  <!-- Twitter Bootstrap viewport setting -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- F5 metadata -->
  <meta name="title" content="Lab 4: Explore AccessGuard(16.0)"/>
  <meta name="product" content="F5 Identity and Access Management Solutions"/>
  <meta name="version" content=""/>
  <meta name="updated_date"  content="2021-06-21 13:45:41"/>
  <meta name="archived" content="Archived documents excluded"/>
  <meta name="doc_type" content="Manual"/>
  <meta name="lifecycle" content="release"/>
  <meta name="F5 Identity and Access Management Solutions" content=""/>


  

  
  <link href="https://cdn.f5.com/favicon.ico" rel="icon">

</head>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lab 4: Explore AccessGuard(16.0) &#8212; F5 Identity and Access Management Solutions  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" href="../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/f5.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/f5-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/CoveoFullSearch.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    <link rel="stylesheet" href="https://use.fontawesome.com/21fb8a09c3.css" type="text/css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Environment Overview" href="../module3/intro.html" />
    <link rel="prev" title="Lab 3: Utilize HTTP Connector(16.0)" href="lab03.html" /> 
  </head><body>
  <div id="clouddocs-header"></div>

    <div id="sidebar" class="section-nav">
      
      <!--  version selector ------------------>
      <div id="version_selector_wrapper">
      </div>
      <nav class="nav-sidebartoc">

        
         <h5>F5 Identity and Access Management Solutions  </h5>
        

        <hr>
        <span class="nav-sidebartoc">
            <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../class1/class1.html">100 Series: Access Foundational Concepts</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../class2.html">200 Series: Assisted Deployment Use Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class3/class3.html">300 Series: Advanced Use Cases &amp; Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class4/class4.html">400 Series: Access Automation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class5/class5.html">500 Series: Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../archived/archived.html">Archived Identity &amp; Access Management Labs</a></li>
</ul>

        </span><!-- Use this file to add extra links to the bottom of the ToC sidebar -->
<hr>
  <span class="nav-sidebartoc">
 <!-- insert content here -->
  </span>
      </nav>
    </div>


    <div id="right-sidebar">
      <h7 style="font-weight:normal">On this page:</h7>
      <nav class="nav-sidebartoc">
        <span class="nav-sidebartoc">
            <ul>
<li><a class="reference internal" href="#">Lab 4: Explore AccessGuard(16.0)</a><ul>
<li><a class="reference internal" href="#section-4-1-xml-configuration-file">Section 4.1 - XML Configuration File</a><ul>
<li><a class="reference internal" href="#task-1-explore-the-configuration-file-setting">Task 1 - Explore the configuration file setting</a></li>
</ul>
</li>
<li><a class="reference internal" href="#section-4-2-system-service">Section 4.2 - System Service</a><ul>
<li><a class="reference internal" href="#task-1-locate-the-f5-access-guard-service">Task 1 - Locate the F5 Access Guard Service</a></li>
</ul>
</li>
<li><a class="reference internal" href="#section-4-3-device-certificate">Section 4.3 - Device Certificate</a><ul>
<li><a class="reference internal" href="#task-1-explore-the-device-certificate">Task 1 - Explore the Device Certificate</a></li>
</ul>
</li>
<li><a class="reference internal" href="#section-4-4-browser-extension">Section 4.4 - Browser Extension</a><ul>
<li><a class="reference internal" href="#task-1-view-the-installed-extension">Task 1 - View the installed Extension</a></li>
</ul>
</li>
<li><a class="reference internal" href="#section-4-5-lab-cleanup">Section 4.5 Lab CleanUp</a><ul>
<li><a class="reference internal" href="#task-1-remove-agc-configuration">TASK 1: Remove AGC Configuration</a></li>
<li><a class="reference internal" href="#task-2-delete-prebuilt-objects">Task 2: Delete Prebuilt objects</a></li>
</ul>
</li>
</ul>
</li>
</ul>

         </span>
      </nav>
    </div>





  
  <div class="main active" id="content" >
    <article class="docs-container site-article-inner">
              <!-- custom breadcrumb -->
        <h5>
            <a href="../../index.html">F5 Identity and Access Management Solutions</a>
              &gt; <a href="../class2.html">200 Series: Assisted Deployment Use Cases</a>

          <span class="right">
             <a href="../../_sources/class2/module2/lab04.rst.txt" rel="nofollow">Source</a> |
             <a href="https://github.com/f5devcentral/f5-agility-labs-iam">Edit on <i class="fa fa-github" aria-hidden="true"></i></a>
          </span>
        </h5>
        <!-- end custom breadcrumb -->
      


    <!--a title="Export PDF" id="export-pdf" class="btn btn btn-link pull-right">View PDF</a-->
    <button type="button" id="export-pdf" class="btn btn-link right">PDF</button>


    
     
         <div class="sidebar" id="version-warning" style="display: none;">
           <p class="first sidebar-title">
           <span class="icon fa fa-info-circle fa-lg"></span> Version notice:</p>
           <p class="last" id="currentVersion"></p>
          </div>


     <div role="main">
        
  <div class="section" id="lab-4-explore-accessguard-16-0">
<h1>Lab 4: Explore AccessGuard(16.0)<a class="headerlink" href="#lab-4-explore-accessguard-16-0" title="Permalink to this headline">¶</a></h1>
<p>F5 Access Guard is a new set of client software tools designed to help administrators validate the security posture of incoming web connections from remote clients. F5 Access Guard allows real-time posture information to be inspected with per-request policy subroutines on BIG-IP Access Policy Manager. F5 Access Guard generates posture information asynchronously and transparently transmits it to chosen APM server endpoints using special HTTP headers</p>
<p>APM has included posture checking capability since its inception, and this new service improves upon this capability by allowing for instantaneous and continuous checks. Deployment of F5 Access Guard is significantly different than previous posture check implementations.</p>
<div class="section" id="section-4-1-xml-configuration-file">
<h2>Section 4.1 - XML Configuration File<a class="headerlink" href="#section-4-1-xml-configuration-file" title="Permalink to this headline">¶</a></h2>
<p>The F5 AccessGuardServiceConfig.xml file defines the settings used by the AccessGuard Service.  This file contains settings for the signing certificate, timers, checks performed and websites posture data can be sent to.</p>
<div class="section" id="task-1-explore-the-configuration-file-setting">
<h3>Task 1 - Explore the configuration file setting<a class="headerlink" href="#task-1-explore-the-configuration-file-setting" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Additional settings can be configured in the XML file beyond this             example.  For further information see the article <strong>Configuring F5 AccessGuard</strong>        on askf5.com - <a class="reference external" href="https://techdocs.f5.com/en-us/bigip-15-0-0/big-ip-access-policy-manager-access-guard-config/configuring-f5-access-guard.html">https://techdocs.f5.com/en-us/bigip-15-0-0/big-ip-access-policy-manager-access-guard-config/configuring-f5-access-guard.html</a></p>
</div>
</div></blockquote>
<ol class="arabic">
<li><p class="first">Open the <strong>F5 Access Guard</strong> Config file shortcut located on the desktop by right clicking it and opening with notepad++</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The file is located in the C:\ProgramData\F5 Networks\F5AccessGuardService directory</p>
</div>
<p><img alt="image0" src="../../_images/image0005.png" /></p>
</li>
<li><p class="first">The <strong>Update</strong> section contains the Software check library auto-update URI. The value specifies the location for software check (OesisInspector.cab) updates.</p>
<p><img alt="image1" src="../../_images/image0018.png" /></p>
</li>
<li><p class="first">The <strong>Signing</strong> section contains the location, cert name, and Issuer Name, of the certificate/key pair used to sign the posture assessment data.</p>
<p><img alt="image2" src="../../_images/image0028.png" /></p>
</li>
<li><p class="first">The <strong>Config</strong> section contains how often posture data is collected and signed. Also the Match patterns for URLs to which the health information would be sent via the HTTP header. This prevents AccessGuard from leaking client configuration data to an untrusted server.</p>
<p><img alt="image3" src="../../_images/image0038.png" /></p>
</li>
<li><p class="first">The <strong>Checks</strong> section contains the check F5 AccessGuard Service will report on.  As of 15.1 there are currently 10 different checks that can be performed.</p>
<p><img alt="image4" src="../../_images/image0048.png" /></p>
</li>
<li><p class="first">Close the configuration file without saving it</p>
</li>
</ol>
</div>
</div>
<div class="section" id="section-4-2-system-service">
<h2>Section 4.2 - System Service<a class="headerlink" href="#section-4-2-system-service" title="Permalink to this headline">¶</a></h2>
<p>The AccessGuard System Service performs the continuous monitoring of the system based on the parameters in the previously explored F5AccessGuardServiceConfig.xml file</p>
<div class="section" id="task-1-locate-the-f5-access-guard-service">
<h3>Task 1 - Locate the F5 Access Guard Service<a class="headerlink" href="#task-1-locate-the-f5-access-guard-service" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first">Enter Services into the jump box’s desktop search bar.</p>
<p><img alt="image5" src="../../_images/image0058.png" /></p>
</li>
<li><p class="first">The F5 Networks Access Guard Service was installed via a .msi available on <a class="reference external" href="https://downloads.f5.com">https://downloads.f5.com</a></p>
<p><img alt="image6" src="../../_images/image0068.png" /></p>
</li>
<li><p class="first">Close the services screen.</p>
</li>
</ol>
</div>
</div>
<div class="section" id="section-4-3-device-certificate">
<h2>Section 4.3 - Device Certificate<a class="headerlink" href="#section-4-3-device-certificate" title="Permalink to this headline">¶</a></h2>
<p>When the configuration file is set to sign posture data, it uses the specified certificate/key pair in the machine’s local certifcate store.</p>
<div class="section" id="task-1-explore-the-device-certificate">
<h3>Task 1 - Explore the Device Certificate<a class="headerlink" href="#task-1-explore-the-device-certificate" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first">Open the jump box’s certificate store by clicking the <strong>Certificate Management</strong> shortcut located on the desktop</p>
<p><img alt="image7" src="../../_images/image0078.png" /></p>
</li>
<li><p class="first">Double click the <strong>jumpbox.f5lab.local</strong> certificate</p>
<p><img alt="image8" src="../../_images/image0088.png" /></p>
</li>
<li><p class="first">Click the <strong>Details</strong> tab and scroll to the Enhanced Key Usage section.  The default usage types associated with a Microsoft CA template is Client Authentication and Server Authentication.  The default template must be modified to include Secure Email.</p>
<p><img alt="image9" src="../../_images/image0098.png" /></p>
</li>
<li><p class="first">Click <strong>OK</strong> and close the Certificate management window</p>
</li>
</ol>
</div>
</div>
<div class="section" id="section-4-4-browser-extension">
<h2>Section 4.4 - Browser Extension<a class="headerlink" href="#section-4-4-browser-extension" title="Permalink to this headline">¶</a></h2>
<p>The browser extension takes the posture data generated by the Access Guard service and converts it to a header.</p>
<div class="section" id="task-1-view-the-installed-extension">
<h3>Task 1 - View the installed Extension<a class="headerlink" href="#task-1-view-the-installed-extension" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first">Open Firefox and enter <strong>about:addons</strong>. Click <strong>Extensions</strong> on the left to see that the F5 Access Guard add-on is installed. The extension is download and installed via a browser’s addon store.</p>
<p><img alt="image10" src="../../_images/0104.png" /></p>
</li>
</ol>
</div>
</div>
<div class="section" id="section-4-5-lab-cleanup">
<h2>Section 4.5 Lab CleanUp<a class="headerlink" href="#section-4-5-lab-cleanup" title="Permalink to this headline">¶</a></h2>
<div class="section" id="task-1-remove-agc-configuration">
<h3>TASK 1: Remove AGC Configuration<a class="headerlink" href="#task-1-remove-agc-configuration" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first">Open a browser, and navigate to <a class="reference external" href="https://bigip1.f5lab.local">https://bigip1.f5lab.local</a></p>
</li>
<li><p class="first">Login with username <strong>admin</strong> and password <strong>admin</strong></p>
<p><img alt="image17" src="../../_images/0173.png" /></p>
</li>
<li><p class="first">Navigate to <strong>Access -&gt; Guided Configuration</strong> in the left-hand menu.</p>
<p><img alt="image11" src="../../_images/0115.png" /></p>
</li>
<li><p class="first">Click the <strong>Undeploy</strong> button on the existing IAP_DEMO configuration</p>
<p><img alt="image12" src="../../_images/0124.png" /></p>
</li>
<li><p class="first">Click <strong>OK</strong> when asked, “Are you sure you want to undeploy this configuration?”</p>
<p><img alt="image13" src="../../_images/0134.png" /></p>
</li>
<li><p class="first">Click the <strong>Delete</strong> button once the deployment is undeployed</p>
<p><img alt="image14" src="../../_images/0144.png" /></p>
</li>
<li><p class="first">Click <strong>OK</strong> when asked, “Are you sure you want to delete this configuration?”</p>
<p><img alt="image15" src="../../_images/0154.png" /></p>
</li>
<li><p class="first">The Configuration section should now be empty</p>
<p><img alt="image16" src="../../_images/0163.png" /></p>
</li>
</ol>
</div>
<div class="section" id="task-2-delete-prebuilt-objects">
<h3>Task 2: Delete Prebuilt objects<a class="headerlink" href="#task-2-delete-prebuilt-objects" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first">From a browser on the jumphost navigate to <a class="reference external" href="https://portal.f5lab.local">https://portal.f5lab.local</a></p>
</li>
<li><p class="first">Click the <strong>Classes</strong> tab at the top of the page.</p>
<blockquote>
<div><p><img alt="image91" src="../../_images/0912.png" /></p>
</div></blockquote>
</li>
<li><p class="first">Scroll down the page until you see <strong>201-v16.0 Zero Trust - Identity Aware Proxy</strong> on the left</p>
<p><img alt="image87" src="../../_images/0872.png" /></p>
</li>
<li><p class="first">Hover over tile <strong>Configure Identity Aware Proxy(16.0)</strong>. A start and stop icon should appear within the tile.  Click the <strong>Stop</strong> Button to trigger the automation to remove any prebuilt objects from the environment</p>
<p><img alt="image88" src="../../_images/0882.png" /></p>
</li>
<li><p class="first">The screen should refresh displaying the progress of the automation within 30 seconds.  Scroll to the bottom of the automation workflow to ensure all requests succeeded.  If you you experience errors try running the automation a second time or open an issue on the <a class="reference external" href="https://github.com/f5devcentral/access-labs">Access Labs Repo</a>.</p>
<p><img alt="image89" src="../../_images/0892.png" /></p>
</li>
<li><p class="first">This concludes lab 4.</p>
<p><img alt="image100" src="../../_images/image1006.png" /></p>
</li>
</ol>
</div>
</div>
</div>


     </div>
    
     <div class="row next-prev-btn-row">
       <div class="col-lg-12">
       
        <a href="lab03.html" title="Lab 3: Utilize HTTP Connector(16.0)" accesskey="p" class="btn btn-primary left"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous</a>
       
       
          <a href="../module3/intro.html" title="Environment Overview" accesskey="n" class="btn btn-primary right">Next <i class="fa fa-arrow-circle-right" aria-hidden="true"></i></a>
       
     </div>
     </div>
    

    </article>
  </div>

</div>


  <div id="clouddocs-footer"></div>
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->

  <script src="../../_static/js/index.js"></script>
  <script src="../../_static/js/jquery.appear.js"></script>
  <script src="../../_static/js/printThis.js"></script>
  <script src="../../_static/js/bootstrap.min.js"></script>
  <script src="../../_static/js/clouddocs.js"></script>
  <script src="../../_static/js/CoveoJsSearch.Lazy.min.js"></script>
  </body>
</html>